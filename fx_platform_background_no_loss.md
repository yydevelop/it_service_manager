# FX自動取引プラットフォームの背景（原文維持版・汎用＋差分）

## 2. FX自動取引プラットフォームの背景

以下の 2.1〜2.8 は、ユーザー提示の原文情報を欠落させないことを最優先に、表現の体裁のみをMarkdownとして整えたものである（情報の要点・粒度は維持する）。また、午後Ⅱで複数テーマに転用できるよう、原文の後ろに「AWS前提の稼働率」「問題と対策」「テーマ別の差分」を追記する。

## 2.1 事業・サービスの位置づけ

- 事業形態  
  - BtoB型ITサービス事業
- 提供サービス  
  - FXブローカー向け自動取引プラットフォーム
- 顧客  
  - 国内FXブローカー（複数社、例：5社）
- エンドユーザー  
  - FXブローカーと直接契約する投資家
- 当社の立場  
  - 投資家とは直接契約・直接サポートを行わない
- 補足  
  - BtoBtoC構造であり、ITサービスマネージャの顧客はFXブローカーである

## 2.2 サービス特性（論文での重要ポイント）

- 為替市場に連動し24時間365日稼働
- 注文処理・約定処理・取引データ連携を含む
- 障害や性能劣化が与える影響
  - FXブローカーの業務停止
  - 投資家の機会損失
  - 社会的信用の低下
- 金融サービスとして高い可用性と迅速な復旧が必須

## 2.3 全体の組織構成

- 経営層
  - CEO（事業責任）
  - CTO（技術責任）
- 開発課
  - アプリケーション開発
  - クラウドインフラ構築・変更
- 運用課（ITサービス提供部門）
  - ITサービスマネージャ
  - サービスデスク
  - 運用担当
- 補足
  - ITサービスマネージャは運用課に所属
  - 「どこにも所属しないITサービスマネージャ」という前提は撤回済み

## 2.4 チーム構成（運用課）

- 運用課：計5名
  - ITサービスマネージャ：1名
  - サービスデスク担当：2名
  - 運用担当：2名
- 補足
  - 運用課3名体制は、24時間365日運用および休暇・属人化の観点から非現実的として不採用
  - 運用課長という別役職は置かず、ITサービスマネージャが運用課を統括

## 2.5 ITサービスマネージャの所属・役割・責任範囲

### 所属

- 運用課に所属するITサービスマネージャ

### 主な役割

- SLA / SLO の策定および見直し
- SLA達成状況の分析・評価
- FXブローカーへの月次サービス報告
- 重大インシデント発生時の統括
  - 優先度判断
  - 顧客への説明方針決定
- 変更管理における最終承認
- エラーバジェットを用いた改善判断

### 明確に行わない業務（減点回避）

- 障害対応の実作業
- 監視作業
- シフト管理の実務
- 開発・実装作業

- 補足  
  - 判断・統制・説明責任に専念する立場とする

## 2.6 サービスデスクの位置づけ

- 運用課に所属
- FXブローカーからの問い合わせ窓口
- 問い合わせ・障害連絡の一次受付
- チケット起票、分類、優先度設定
- 定型的な顧客連絡および進捗共有
- ITサービスマネージャへの集計・定期報告

## 2.7 運用担当の位置づけ

- 監視結果の確認
- 障害一次切り分け
- 手順に基づく暫定復旧
- 開発課へのエスカレーション
- 定常運用作業（ジョブ、バックアップ等）

## 2.8 サービス提供形態（24時間365日対応）

### 基本方針

- 24時間365日稼働 ＝ 常時有人対応ではない
- 内製3交代制は採用しない

### 外部委託（確定）

- 夜間・休日の監視は外部運用監視センター（NOC）に委託
- 外部NOCが24時間365日で監視を実施

### 障害時の対応フロー

- P1（重大障害）
  - 即時に社内オンコールへ通知
- P2以下
  - チケット起票し翌営業日に対応
- 社内オンコール
  - 運用担当が輪番
  - ITサービスマネージャはバックアップ対応

## 2.9 AWS前提の稼働率（SLA/SLO）定量化

- 目的
  - 「稼働率をAWSサービス利用前提で詳細化」し、午後Ⅱでの判断・意思決定（停止許容、凍結判断、部分再開判断、委託先管理）に直結させる
- 前提
  - 24時間365日稼働のため、稼働率は月次評価（暦月）で管理する
- 顧客向けSLA（可用性）
  - 月間稼働率：99.95%（目標）
  - 月間停止許容時間：21.6分（30日換算）
  - 年間停止許容時間：4.38時間（365日換算）
- 社内SLO（可用性）
  - 月間稼働率：99.97%（目標）
  - 月間停止許容時間：12.96分（30日換算）
- 稼働率の測定方法（サービス視点に固定）
  - 監視対象は「注文受付から約定、取引データ連携までが成立していること」
  - 片系稼働（例：注文は受け付けるが約定不可）は稼働とは見なさない
  - 外形監視（API疎通）と内部指標（キュー滞留、約定成功率、DB接続枯渇）を併用する

## 2.10 稼働率に関する具体的な問題（AWS前提でも起きること）

- 問題1
  - マルチAZを採用していても、アプリ全滅により「取引不可」になる
  - 典型原因
    - 変更作業で設定誤りが全AZに波及
    - デプロイ失敗で全ターゲットが異常
  - なぜ問題か
    - AWSの可用性が高くても、当社の変更管理ミスで停止が発生し、SLA違反が当社責任となる
- 問題2
  - 重大インシデント時に「全面復旧」しか手段がない
  - 典型原因
    - 部分再開（新規停止・決済のみ）の設計と手順が未整備
  - なぜ問題か
    - 復旧が長引くほど投資家損失が拡大し、ブローカーが当社を切り離す意思決定をしやすくなる
- 問題3
  - 夜間・休日の監視委託（NOC）と社内オンコールの連携不備で検知・通知が遅れる
  - 典型原因
    - 連絡先・優先度基準の更新漏れ
    - 誤検知が多く、通知が形骸化
  - なぜ問題か
    - 初動遅延が停止時間に直結し、月間21.6分の停止許容を短時間で消費する

## 2.11 対策（ITサービスマネージャとしての判断・統制に固定）

- 対策1（変更管理の統制）
  - 変更の最終承認はITサービスマネージャが実施し、重大リスク変更は段階展開を必須化する
  - 実施事項
    - 変更前リスク評価（影響範囲、ロールバック可否、監視強化）
    - 段階展開（カナリア、ブルーグリーン等）により全滅を回避
    - 自動／手動ロールバック条件を数値で定義（例：約定成功率低下、エラー率上昇）
- 対策2（部分再開の設計）
  - P1時の再開モードを事前に定義し、手順化する
  - 例
    - 新規注文停止、決済のみ許可
    - 参照系（残高・建玉照会）のみ再開
  - 効果
    - 投資家損失の拡大を抑止し、ブローカーへの説明が「方針」として一貫する
- 対策3（外部委託管理の統制）
  - NOCと当社のSLA/KPIを明確化し、月次でレビューする
  - 合意例
    - 検知：5分以内、通知：10分以内
    - 誤検知率：月2%未満
    - 連絡網不達：0件
  - 運用
    - 人事異動・体制変更時に連絡体制を即更新し、訓練で実効性確認を行う

## 2.12 午後Ⅱテーマ別の差分（汎用は固定し、ここだけ差し替える）

### 差分A（重大インシデント管理向け）

- 想定事象
  - 経済指標発表時の注文集中によりDB接続が枯渇し、約定処理が滞留
- 影響の置き方
  - 約定不可：最大15分
  - ブローカー5社中3社に影響（2社は軽微）
- ITサービスマネージャの判断
  - 全面復旧を待たず、部分再開（新規停止・決済のみ）を指示
  - 顧客説明方針を決定し、ブローカーへ一次報告を優先する

### 差分B（ITサービス継続性管理向け）

- 目標
  - RTO：30分以内
  - RPO：0分（取引データ）
- 日頃の活動
  - 復旧訓練を年2回（机上＋実地）で実施
  - 変更時は復旧手順書を即改訂し、連絡体制も更新する

### 差分C（ITサービス移行向け）

- 制約
  - 停止許容：最大10分
  - 切戻し判定：5分以内
- 工夫
  - 本番相当負荷での移行リハーサルを複数回実施
  - 移行後レビュー結果をナレッジ化し、次回移行に反映する
